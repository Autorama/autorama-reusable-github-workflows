name: ci-ror-workflow

on:
  workflow_call:
    inputs:
      env:
        description: 'the environment'     
        type: string
        default: 'dev'
        required: true

jobs:
  unit-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Unit Test
        run: |
          docker-compose -f docker-compose.ci.yml -p 123 build web
          docker-compose -f docker-compose.ci.yml -p 123 run -u $(id -u) \
            -e HOME=/tmp -e RAILS_ENV=test web \
            bundle exec rspec --format RspecJunitFormatter --out results.xml \
            --format progress --format documentation